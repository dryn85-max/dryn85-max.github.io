<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Meshtastic Gateway Config</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ∞ Meshtastic Gateway</h1>
            <p class="subtitle">Configure WiFi, Telegram & LoRa Settings</p>
        </header>

        <div id="status-card" class="card status-card">
            <div class="status-header">
                <span class="status-icon">üì°</span>
                <span id="current-status" class="status-text">Loading...</span>
            </div>
        </div>

        <div class="card">
            <h2>üì∂ WiFi Settings</h2>
            
            <div class="form-group">
                <label for="wifi-ssid">WiFi SSID *</label>
                <input type="text" id="wifi-ssid" class="input" placeholder="Your WiFi Network" required>
            </div>

            <div class="form-group">
                <label for="wifi-password">WiFi Password *</label>
                <input type="password" id="wifi-password" class="input" placeholder="Your WiFi Password" required>
                <button type="button" class="toggle-password" onclick="togglePassword('wifi-password')">üëÅÔ∏è</button>
                <p class="hint">Leave blank for open networks</p>
            </div>
        </div>

        <div class="card">
            <h2>ü§ñ Telegram Settings</h2>
            
            <div class="form-group">
                <label for="bot-token">Bot Token *</label>
                <input type="password" id="bot-token" class="input" placeholder="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz" required>
                <button type="button" class="toggle-password" onclick="togglePassword('bot-token')">üëÅÔ∏è</button>
                <p class="hint">Get from @BotFather on Telegram</p>
            </div>

            <div class="form-group">
                <label for="chat-id">Chat ID *</label>
                <input type="text" id="chat-id" class="input" placeholder="123456789" required>
                <p class="hint">Get from @userinfobot on Telegram</p>
            </div>
        </div>

        <div class="card">
            <h2>üì° LoRa Settings</h2>
            
            <div class="form-group">
                <label for="lora-region">Region *</label>
                <select id="lora-region" class="input" required>
                    <option value="0">UNSET</option>
                    <option value="1">US</option>
                    <option value="2">EU_433</option>
                    <option value="3" selected>EU_868</option>
                    <option value="4">CN</option>
                    <option value="5">JP</option>
                    <option value="6">ANZ</option>
                    <option value="7">KR</option>
                    <option value="8">TW</option>
                    <option value="9">RU</option>
                    <option value="10">IN</option>
                    <option value="11">NZ_865</option>
                    <option value="12">TH</option>
                    <option value="13">UA_433</option>
                    <option value="14">UA_868</option>
                </select>
                <p class="hint">Select your LoRa frequency region</p>
            </div>

            <div class="form-group">
                <label for="lora-modem">Modem Preset *</label>
                <select id="lora-modem" class="input" required>
                    <option value="0" selected>LONG_FAST (Default)</option>
                    <option value="1">LONG_SLOW</option>
                    <option value="2">VERY_LONG_SLOW</option>
                    <option value="3">MEDIUM_SLOW</option>
                    <option value="4">MEDIUM_FAST</option>
                    <option value="5">SHORT_SLOW</option>
                    <option value="6">SHORT_FAST</option>
                    <option value="7">LONG_MODERATE</option>
                </select>
                <p class="hint">LoRa modulation settings (affects range/speed)</p>
            </div>
        </div>

        <div class="card info-card">
            <h3>‚ÑπÔ∏è How It Works</h3>
            <ul class="info-list">
                <li><strong>Gateway Mode:</strong> Messages forwarded between LoRa mesh and Telegram</li>
                <li><strong>Full Mesh:</strong> Device acts as a repeater for other nodes</li>
                <li><strong>Changes take effect:</strong> After device reboot (~10 seconds)</li>
                <li><strong>Reconfigure:</strong> Hold BOOT button for 3 seconds during power-on</li>
            </ul>
        </div>

        <div class="button-group">
            <button id="save-btn" class="btn btn-primary" onclick="saveConfig()">
                üíæ Save & Reboot
            </button>
            <button id="cancel-btn" class="btn btn-secondary" onclick="closeApp()">
                ‚ùå Cancel
            </button>
        </div>

        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p>Saving configuration...</p>
        </div>

        <div id="success" class="message success hidden">
            <span class="icon">‚úÖ</span>
            <div class="text">
                <strong>Configuration Saved!</strong>
                <p>Device will reboot in a few seconds...</p>
            </div>
        </div>

        <div id="error" class="message error hidden">
            <span class="icon">‚ùå</span>
            <div class="text">
                <strong>Error!</strong>
                <p id="error-message">Failed to save configuration</p>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
